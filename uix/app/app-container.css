:where(.uix-app-container, uix-app-container) {
  /* Layout */
  display: flex;
  width: 100%;
  overflow: hidden;

  /* Safe area support */
  &[use-safe-area] {
    --safe-top: env(safe-area-inset-top);
    --safe-bottom: env(safe-area-inset-bottom);
    --safe-left: env(safe-area-inset-left);
    --safe-right: env(safe-area-inset-right);
  }

  /* ============================================
     MOBILE LAYOUT
     ============================================ */

  &::part(container) {
    display: flex;
    flex-direction: column;
    width: 100%;
    position: relative;
    background: var(--color-background);
  }

  /* Mobile content area */
  &::part(content) {
    flex: 1;
    min-height: 0;
    overflow-y: auto;
    overflow-x: hidden;
    -webkit-overflow-scrolling: touch;
    padding: var(--content-padding, 0);
  }

  /* Adjust padding when header is fixed */
  &[header-fixed]::part(content) {
    padding-top: calc(56px + var(--safe-top, 0px));
  }

  /* Adjust padding when bottom nav is shown */
  &[show-bottom-nav]::part(content) {
    padding-bottom: calc(56px + var(--safe-bottom, 0px));
  }

  /* Floating action button positioning */
  [slot="floating-action"] {
    position: fixed;
    bottom: calc(72px + var(--safe-bottom, 0px));
    right: var(--spacing-lg);
    z-index: 90;
  }

  &:not([show-bottom-nav]) [slot="floating-action"] {
    bottom: calc(var(--spacing-lg) + var(--safe-bottom, 0px));
  }

  /* ============================================
     DESKTOP LAYOUT
     ============================================ */

  /* Desktop body (contains sidebar + main + panel) */
  &::part(body) {
    display: flex;
    flex: 1;
    min-height: 0;
    overflow: hidden;
  }

  /* Desktop main area (toolbar + content) */
  &::part(main) {
    display: flex;
    flex-direction: column;
    flex: 1;
    min-width: 0;
    overflow: hidden;
  }

  /* Toolbar */
  &::part(toolbar) {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    min-height: 40px;
    padding: var(--spacing-xs) var(--spacing-md);
    background: var(--color-surface);
    border-bottom: 1px solid var(--color-border);
  }

  /* Secondary panel (multi-pane mode) */
  &::part(panel) {
    display: flex;
    flex-direction: column;
    width: 300px;
    min-width: 200px;
    max-width: 600px;
    border-left: 1px solid var(--color-border);
    background: var(--color-surface);
    overflow-y: auto;
    resize: horizontal;
  }

  /* Status bar */
  &::part(statusbar) {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--spacing-sm);
    min-height: 24px;
    padding: var(--spacing-xs) var(--spacing-md);
    background: var(--color-surface);
    border-top: 1px solid var(--color-border);
    font-size: var(--text-xs, 0.75rem);
    color: var(--color-text-muted);

    &:empty {
      display: none;
    }
  }

  /* ============================================
     SIDEBAR INTEGRATION
     ============================================ */

  uix-sidebar {
    height: 100%;
    border-right: 1px solid var(--color-border);

    /* Right-positioned sidebar */
    &[position="right"] {
      order: 3;
      border-right: none;
      border-left: 1px solid var(--color-border);
    }
  }

  /* ============================================
     SLOT CONTENT STYLING
     ============================================ */

  /* Toolbar slot content */
  [slot="toolbar"] {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    width: 100%;
  }

  /* Status bar slot content */
  [slot="status-bar"] {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
  }

  /* ============================================
     ACCESSIBILITY
     ============================================ */

  /* Focus visible styles */
  *:focus-visible {
    outline: 2px solid var(--color-primary);
    outline-offset: 2px;
  }
}

/* ============================================
   RESPONSIVE ADJUSTMENTS
   ============================================ */

/* Desktop content area - additional padding for desktop */
@media (min-width: 768px) {
  :where(.uix-app-container, uix-app-container)::part(content) {
    padding: var(--content-padding, var(--spacing-lg));
    background: var(--color-background);
  }
}

/* Tablet portrait: adjust sidebar */
@media (min-width: 768px) and (max-width: 1023px) {
  :where(.uix-app-container, uix-app-container) {
    uix-sidebar {
      width: 240px;
    }

    &::part(content) {
      padding: var(--spacing-md);
    }
  }
}

/* Small desktop: adjust panel */
@media (min-width: 1024px) and (max-width: 1279px) {
  :where(.uix-app-container, uix-app-container)::part(panel) {
    width: 250px;
  }
}

/* Large desktop: increase content padding */
@media (min-width: 1440px) {
  :where(.uix-app-container, uix-app-container)::part(content) {
    padding: var(--content-padding, var(--spacing-xl));
  }
}

/* ============================================
   THEME VARIANTS
   ============================================ */

/* Dark theme adjustments */
@media (prefers-color-scheme: dark) {
  :where(.uix-app-container, uix-app-container) {
    &::part(toolbar) {
      background: var(--color-surface-dark);
    }

    &::part(statusbar) {
      background: var(--color-surface-dark);
    }
  }
}

/* ============================================
   REDUCED MOTION
   ============================================ */

@media (prefers-reduced-motion: reduce) {
  :where(.uix-app-container, uix-app-container)::part(content) {
    scroll-behavior: auto;
  }
}

/* ============================================
   PRINT STYLES
   ============================================ */

@media print {
  :where(.uix-app-container, uix-app-container) {
    height: auto;

    &::part(container) {
      display: block;
      height: auto;
    }

    uix-app-header,
    uix-bottom-nav,
    uix-title-bar,
    uix-sidebar {
      display: none;
    }

    &::part(toolbar),
    &::part(statusbar),
    &::part(panel) {
      display: none;
    }

    &::part(content) {
      overflow: visible;
      height: auto;
      padding: 0;
    }
  }
}
